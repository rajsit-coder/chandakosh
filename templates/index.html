<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Chandas Identifier</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet">
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Chandas Identifier</h1>
      <p class="subtitle">Detects Laghu/Guru patterns and matches classic meters (Gayatri, Anushtubh, Trishtubh, etc.).</p>
    </header>

    <section>
      <form method="post" class="panel">
        <label for="shloka">Paste a shloka (Devanagari or IAST). Use danda "।" or line breaks if available.</label>
        <textarea id="shloka" name="shloka" rows="6" placeholder="{{ sample }}">{{ request.form.get('shloka', '') or sample }}</textarea>

        <div class="row">
          <label for="script">Script</label>
          <select id="script" name="script">
            <option value="auto" {% if request.form.get('script')=='auto' or not request.form.get('script') %}selected{% endif %}>Auto</option>
            <option value="devanagari" {% if request.form.get('script')=='devanagari' %}selected{% endif %}>Devanagari</option>
            <option value="latin" {% if request.form.get('script')=='latin' %}selected{% endif %}>Latin (IAST)</option>
          </select>
        </div>

        <button type="submit">Identify Chandas</button>
      </form>
    </section>

    {% if result %}
    <section class="panel result">
      <h2>Result</h2>
      <div class="grid">
        <div>
          <p><strong>Detected script:</strong> {{ result.script }}</p>
          <p><strong>Guessed meter:</strong> {{ result.guess.name }}</p>
          <p><strong>Target:</strong> {{ result.guess.target_padas }} padas × {{ result.guess.target_len }} syllables</p>
          <p><strong>Confidence:</strong> {{ result.guess.confidence }}</p>
        </div>
        <div>
          <p><strong>Parsed padas:</strong> {{ result.pada_counts|length }}</p>
          <p><strong>Pada counts:</strong> {{ result.pada_counts|join(", ") }}</p>
          <p class="note">{{ result.note }}</p>
        </div>
      </div>

      <h3>Pada patterns (G = Guru, L = Laghu)</h3>
      <table>
        <thead><tr><th>#</th><th>Syllables</th><th>Pattern</th></tr></thead>
        <tbody>
          {% for p in result.padas %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ p.count }}</td>
            <td class="mono">{{ p.pattern }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
    {% endif %}

    <footer>
      <p>Tip: If your shloka has only two lines, the app will try a 2→4 pada split automatically.</p>
    </footer>
  </div>
</body>
</html>